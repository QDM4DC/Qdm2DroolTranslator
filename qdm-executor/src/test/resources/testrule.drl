import edu.mayo.qdm.drools.PreconditionResult;
import edu.mayo.qdm.patient.Patient;
import java.util.List;
import edu.mayo.qdm.drools.DroolsUtil;

global DroolsUtil droolsUtil

rule "Precondition #3"
      dialect "mvel"
  when
      PreconditionResult( id == "Precondition #2" )
  then
      insert(new PreconditionResult("Precondition #3", null))

end

rule "Precondition #1"
      dialect "mvel"
  when
      $p : Patient()
      $l : List(size > 0)  from collect( edu.mayo.qdm.patient.Lab( startDate > "01-Jan-1980" ) from $p.getLabs() )
  then
      System.out.println($l);
      insert(new PreconditionResult("Precondition #1", $p))

end

rule "Precondition #2"
      dialect "mvel"
  when
      $p : Patient ()
  then
	  insert(new PreconditionResult("Precondition #2", $p))
end

rule "Initial Patient Population"
      dialect "mvel"
  when
    Patient( birthdate >= "01-Jan-1980")

  then
      System.out.println("hi!!!");

end
